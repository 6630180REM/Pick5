<!DOCTYPE html>
<html>
<head>
  <title>Firebase Admin Panel</title>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-functions-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body>
  <h1>Send Push Notification</h1>
  <textarea id="message" placeholder="Notification message"></textarea><br><br>
  <button onclick="sendNotification()">Send Notification</button>

  <script>
    const firebaseConfig = {
  apiKey: "AIzaSyB5r_KL2eKVFd66VQU_5pznKrVHa9xzCfc",
  authDomain: "joespick5push.firebaseapp.com",
  projectId: "joespick5push",
  storageBucket: "joespick5push.firebasestorage.app",
  messagingSenderId: "783669343677",
  appId: "1:783669343677:web:c1f72d2a2a58b0349a4ed4",
  measurementId: "G-JDCJZPXHZM"
    };
    firebase.initializeApp(firebaseConfig);
    const functions = firebase.functions();
    const db = firebase.firestore();

    async function sendNotification() {
      const message = document.getElementById('message').value;
      const sendPushNotification = functions.httpsCallable('sendPushNotification');
      const tokens = [];

      try {
        const snapshot = await db.collection('fcmTokens').get();
        snapshot.forEach(doc => {
          tokens.push(doc.id);
        });

        const result = await sendPushNotification({ message: message, tokens: tokens });
        console.log('Notification sent:', result);
        alert('Notification sent!');
      } catch (error) {
        console.error('Error sending notification:', error);
        alert('Error sending notification: ' + error.message);
      }
    }
  </script>
</body>
</html>
